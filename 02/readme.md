# 二、布尔计算

> Therefore, constructive understanding of binary addition
> holds the key to understanding many fundamental operations performed by
> the computer’s hardware.

## 总结

本章在第一章的基础上搭建了半加器、全加器、多位加法器和加一计数器。

同时，本章搭建了HACK计算机的ALU。ALU有6位控制信号，可对两个16位的操作数进行多种基本运算并输出。

## 进制转换

2 -> 10: 依权重相加。

10 -> 2: 以2除十进制数，余数即为最低位的值。以商作为新的十进制数，递归，可得结果。

## 负数表示

对N位二进制有符号数，通常采用方式补码实现，即原码取反再加一。利用二进制计算舍去溢出位的特点实现负数计算。

可理解为作映射

$$(-2^{N-1}, -1) \to (2^{N-1}, 2^N-1)\Rightarrow x + (-x) = 2^N = 0$$

输入输出位数相同，结果的值应当处于可表示的范围内，否则需增加系统位数。

这一方法的关键优点是硬件实现时非常简单，加法器无需任何修改，符号判断也易于实现。

## 加法器

组合逻辑的多位加法器时序上存在竞争冒险问题，低位的进位信号需要更长的时间到达。

串行进位加法器设计简单，但速度慢。超前进位加法器通过增加电路的复杂度，更快得到高位的进位信号。

## ALU

![fig2.5](../images/Ch0201.png)

算术逻辑单元。通过控制端实现对操作数的多种计算。

HACK的ALU有六个控制端，分别控制对操作数置零、取反、相加、相与以及对结果取反，组合起来可以实现丰富的功能。

注意取反和负数的区别。对N位系统：

$$x\in (0,2^{N-1}-1),\quad !x = 2^N-1-x,\quad -x=2^N-x,\quad !(-x)=x-1$$

此ALU硬件设计简单，但功能足够。作者说是通过列出想实现的功能再逆推化简的方式设计而来。

此ALU没有乘除及浮点等功能，后续将通过操作系统等软件方式实现。注意实际的ALU往往会通过硬件实现这类基本算术功能，以成本换取软件运行速度。

## 代码

比第一章还简单，照提示来即可。注意第零位为LSB，只允许在输出端切片，zr在out全零时置高。